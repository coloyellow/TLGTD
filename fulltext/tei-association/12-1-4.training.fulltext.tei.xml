<?xml version="1.0" ?><tei xml:space="preserve"><teiHeader><fileDesc xml:id="0"/></teiHeader><text xml:lang="en"><head>壹、前言<lb/></head><p> 長久以來，圖書館作業相關報表的繁雜需求，一直是困擾圖書館<lb/> 自動化系統開發商沉痾已久的問題。以往的解決方式，多數是以客製<lb/> 化另案開發方式解決。圖書館若採用國內廠商開發之自動化系統，其<lb/> 報表客製化需求，多數是由系統廠商以系統維護名義或是新增功能模<lb/> 式協助解決；而採用國外廠商開發之自動化系統者，其客製化報表需<lb/> 求解決之道，若非個案開發索價驚人，亦僅能反映原廠公司待可能增<lb/> 加新功能之改版系統。近幾年圖書館資訊能力逐漸強化，再加上圖書<lb/> 館自動化系統後端資料庫的開放，系統館員亦已能夠藉由結構化查詢<lb/> 語言 SQL(Carlos &amp; Morris, 2016)承擔部分報表產生，供管理階層解<lb/> 決燃眉之急。<lb/></p><p> Ex Libris 於 2005 年首先針對其圖書館自動化系統 Aleph 發展一<lb/> 以資料倉儲技術為基礎之報表產生系統 Aleph Reporting Center(簡稱<lb/> ARC)，提供其客戶選擇適於各館所需之預存報表，以協助解決圖書<lb/> 館報表需求之窘境。先不論各館應用 ARC 效益及功能如何，對於其他<lb/> 非 Aleph 各館之報表需求，該如何有效彈性解決？是圖書館自動化系<lb/> 統運用向來亟待解決的問題。<lb/></p><p> 另外，台灣圖書館管理議題一直是少被重視的，尤其是管理決策<lb/> 層面的問題，或因牽涉太多環境政治因素影響，多數仍舊偏重於管理<lb/> 者經驗的決定，以實證為主(Evidence-Based)之圖書館管理決策，卻<lb/> 是少見。然在其他應用領域，資料倉儲技術卻是已經可提供環境運作<lb/> 事實結果供決策者參考，用以改善其作業效率，增進其服務品質。此<lb/> 部分之需求，當然會因各館之狀況不同而有所差異，也因此非事先定<lb/> 義之資料倉儲架構可以完整解決的，必須進行相關客製化以滿足圖書<lb/> 館個別之需求。<lb/></p><p> 基於上述圖書館報表需求與管理決策參考需要，本研究提出一以<lb/> 資料倉儲為基礎之圖書館自動化系統客製化報表產生模式，並藉由實<lb/> 際案例證實，在現有稍具資料庫基礎之圖書館系統館員作業下，此模<lb/> 式之可行性及其效益性。<lb/></p><head> 貳、文獻回顧<lb/></head><p> 本研究於探討圖書館自動化報表客製化，所涉及之資訊技術概<lb/> 念，主要有：資料倉儲(Data Warehouse)、資料超市(Data Mart)、<lb/> 多維度資料模式(Multi-Dimensional Data Model)、事實資料表(Fact<lb/> Table)等。<lb/></p><p>一、資料倉儲<lb/>就現今資料庫資訊技術而言，資料倉儲(Inmon, 2008; Kimball &amp;<lb/> Ross, 2013; Massis, 2016; Nicholson, 2003; Nicholson, 2006; Shieh,<lb/> 2010; Wah, Peng &amp; Hok, 2007; 謝建成，2009)並不是甚麼特別新穎的<lb/> 技術，其應用範圍相當廣泛，主要是以支援提供管理階層所需之資訊。<lb/> 台灣圖書館於管理階層資訊之需求，多數是以固定週期之呈報報表為<lb/> 主，如呈報給上級單位之月報、季報、年報等。<lb/></p><p> 資料倉儲為整合性的資訊儲存體(Repository)，是由多個分散式、<lb/> 自主性、異質性的資料來源(data sources)彙整而成以供查詢及分析。<lb/> 運用資料倉儲主要目的，一是資料管理：由資料不同的角度從事資料<lb/> 分析或資料整合，以有效掌握現存資料狀態；二是資料展現：專注在<lb/> 建立新種類的報告，例如策略性的趨勢分析，以提供決策所需資訊。<lb/></p><p> Inmon(2008) 定 義 資 料 倉 儲：「 是 一 俱 主 題 導 向(subject-<lb/>oriented)、整合性(integrated)、時間變異性(time-variant)及不變<lb/> 動性(nonvolatile)的大量資料聚合，以支援管理之決策過程」。<lb/></p><p> ( 一 ) 主題導向<lb/> 資料倉儲系統不同於日常操作異動系統，期主要是針對輔助決策者<lb/> 進行資料分析，因此資料倉儲必須依據某個主題或領域來建置，排除於<lb/> 決策過程中非參考性資料；以保險業為例，一般異動作業系統以壽險、<lb/> 健康險、意外險等產品為主題，而資料倉儲則以顧客資料、保險費成本<lb/> 分析、理賠資料分析等為主題。<lb/></p><p> ( 二 ) 整合性<lb/> 資料倉儲系統之資料來源為不同異動作業層系統或異質資料庫，<lb/> 如關聯式資料庫、一般檔案與線上異動系統紀錄等，而資料型態與定<lb/> 義在其原有系統或資料庫中，可能有不一致的定義。因此資料轉置載<lb/> 入資料倉儲前，必須先經由轉換、篩選或淨化過程，以確保命名、結<lb/> 構與屬性的一致性，因此其資料具有整合性的特性；例如，系統 A 其<lb/> 男 / 女定義為 M/F、系統 B 其男 / 女定義為 1/0、而系統 C 其男 / 女定<lb/> 義為 X/Y，在將此三個系統資料彙整成資料倉儲時，必須重新定義為<lb/> 男 / 女為 M/F。<lb/></p><p> ( 三 ) 資料不變動性<lb/>資料倉儲系統與日常操作交易系統是獨立的，一般操作交易系統<lb/> 其資料庫皆提供資料新增、修改、刪除、查詢等功能，而資料倉儲系<lb/> 統之資料庫僅是資料載入與資料讀取分析功能，其新增、修改與刪除<lb/> 等異動功能，需在原有操作系統之資料庫處理；因此資料倉儲所需的<lb/> 操作只有資料初始載入與資料存取，其資料是具有不變動性的特質。<lb/></p><p> ( 四 ) 時間變異性<lb/> 一般線上作業層異動系統(online transaction processing，OLTP)之<lb/> 資料處理，為即時與日常性每日異動資料，而資料倉儲系統處理資料<lb/> 為過去歷史與年度或季節性資料。並經由過去歷史性資料累積，以時<lb/> 間因素為角度來分析，提供長期性資料趨勢與特性，作為支援決策的<lb/> 依據。因此，一般資料倉儲皆有設計時間維度，以分析其資料長期性<lb/> 趨勢與特性。<lb/></p><p> 綜整而言，資料倉儲是不同於日常營運異動的資料庫，是單位於<lb/> 分析特殊需求訂定主題後，萃取自日常異動的資料庫之相關資料所建<lb/> 構成，主要是為了協助單位執行管理上的決策。另外由於資料倉儲具<lb/> 備資料整合的特性，對於分散於不同系統間的資料而言，資料倉儲能<lb/> 提供穩固的平台，以整合性的架構進行系統整合，有效規劃歷史資料<lb/> 的管理。<lb/></p><p> 1. 資料倉儲架構<lb/> 就系統架構層面探討，資料倉儲架構可分為三層(Han, Kamber, &amp;<lb/> Pei, 2011)：資料倉儲伺服器(data warehouse server)、線上分析處理<lb/> 伺服器(OLAP server)與前端工具(front-end tools)，如圖 1 所示。<lb/> 資料倉儲的資料來源為現有作業層系統或其它外部資料，並經由篩選、<lb/> 轉換、擷取，轉至最底層的資料倉儲伺服器。最底層的資料倉儲伺服<lb/> 器其架構除資料倉儲外，還包含資料超市或定義資料結構的詮釋資料<lb/> (Metadata)。資料倉儲資料經由中間層次資料模式與維度定義、資料<lb/> 儲存格式與資料立方體預存處理；輸出層最前端為一般使用者報表、<lb/> 查詢、線上分析處理 或資料探勘等分析工具的利用。<lb/></p><p> 2. 資料超市<lb/> 資料超市(Data Mart)為一小型的資料倉儲系統，邏輯上為資料<lb/> 倉儲的一個子集合，其規模較資料倉儲為小，可能涵蓋範圍為某一特<lb/> 定部門或區域的主題範圍，且僅能提供該部門或區域的資料，並給予<lb/> 特定人員或部門使用，以符合實際運作需求，例如圖書館採訪部門在<lb/> 資料倉儲的應用，訂定與其業務相關主題為館藏採購與圖書出版社間<lb/> 的關係，因此所需的資料即包括館藏資料、出版社資料及讀者推薦資<lb/> 料等所建構之資料超市，而非整個圖書館所需之資料倉儲(讀者資料、<lb/> 流通資料等)；但其建構技術與整個資料倉儲無異。<lb/></p><figure> 圖 1Ā 資料倉儲架構(Han, Kamber, &amp; Pei, 2011)<lb/></figure><p>3. 線上分析處理<lb/> 線上分析處理(Online Analytical Processing)是針對以多維度資料<lb/> 模 式(Multi-dimensional Data Model， 或 稱 之 為 資 料 立 方 體，Cube)<lb/> 所建立之資料倉儲資料進行分析。多維度資料模式是以主題事實資<lb/> 料表(Fact Table)為中心，加以組織彙整相關資料，此事實資料表包<lb/> 括事實資料表的名稱、計量(measure)項目，以及相關維度資料表<lb/> (dimension table)之關鍵字(key)，例如有關銷售紀錄之資料倉儲，<lb/> 定義名為銷售業績之事實資料表，可包含銷售款項、銷售數量等計量<lb/> 項目，以及其相關維度表之關鍵字：銷售員員工編號、產品編號、時<lb/> 間序號等，透過此事實表之組織整合相關資料，我們可以多維度分析<lb/> 探究：不同銷售員於各季銷售各項產品的數量、銷售總金額，不同產<lb/> 品於各月銷售數量、銷售總金額等有助於管理決策的資訊。<lb/></p><p> 4. 維度資料模式<lb/> 多維度資料模式是以所確定之主題為中心加以組織彙整相關資料<lb/> 來源，該主題以事實資料表表示。多維度資料模式可以是以星狀綱要<lb/> 模式、雪花狀綱要模式或星座狀綱要模式的形式存在：<lb/></p><p> (1) 星狀綱要(Star Schema)模式<lb/> 此綱要之資料倉儲包含兩部分：一個包含大量資料的事實資料表，<lb/> 另有一組小的附屬表，稱之為維度資料表(dimension table)，每個維<lb/> 度都有一個相對應的維度資料表。這種模式很像星星爆發，眾多的維<lb/> 度資料表環繞在中心表四周形輻射狀，如圖 2 所示。<lb/></p><p> (2) 雪花狀綱要(Snowflakes Schema)模式<lb/> 雪花狀綱要模式是星狀綱要模式的變形，其中的某些維度資料表<lb/> 經過正規化，為減少資料多餘情形，因而把維度資料表進一步分解成<lb/> 連結的兩個資料表，而資料綱要圖形就類似於雪花的形狀，如圖 3 所<lb/> 示。這樣的資料綱要表易於維護，並節省儲存空間，但是由於執行查<lb/> 詢需要較多的資料表結合(table join)動作，因此雪花狀綱要可能會降<lb/> 低瀏覽資料的效益。<lb/></p><figure> 圖 2Ā 星狀綱要模式<lb/></figure><p> (3) 星座狀綱要(Constellation Schema)模式<lb/> 這類的綱要模式，可以視作星狀綱要模式的一群組合，因此又被<lb/> 稱為星系綱要模式(Galaxy Schema)，此綱要存在許多事實資料表，<lb/> 這些事實資料表是共用維度資料表，如圖 4 所示。<lb/></p><figure> 圖 3Ā 雪花狀綱要模式<lb/></figure><figure> 圖 4Ā 星座狀綱要模式<lb/></figure><p> 二、Aleph Reporting Center(ARC)<lb/>ARC(Heather, 2007; Heather &amp; Liya, 2009; Hurlbert, 2008) 是<lb/> ExLibris 公司針對其圖書館自動化系統 Aleph 所開發的報表系統，目前<lb/> 最新的版本為 4.0。ARC 為一基於 Web 的報表、查詢及統計資料產生<lb/> 環境，其資料來源為 Aleph 自動化系統，讓使用者可立即存取有關圖<lb/> 書館各種特定統計資料。ARC 發展自 IBM Cognos ReportNet 軟體，並<lb/> 與其整合構成系統環境。ARC 內之作業層資料是蒐集自從各種 Aleph<lb/> 資料資源，並以邏輯結構呈現以使其得以於系統多個區域間互相參照。<lb/> 使用者可以操作作業層資料產生報表以及每天工作流程所需之統計資<lb/> 料。ARC 結合特定、整合資料之蒐集，依據圖書館歷史深度(時間年<lb/> 度)與不同主題層面進行資料組織。ARC 利用資料倉儲方法實現快速<lb/> 有效的資訊檢索，而所建構之資料倉儲為一獨立之資料庫，以固定模<lb/> 式自現有作業層系統擷取資訊，並以適合使用者直接存取的特定架構<lb/> 設計。ARC 系統概念如下圖 5 所示：<lb/></p><figure> 圖 5ĀARC 系統概觀(ExLibris, 2014)<lb/></figure><p> ARC 是利用資料倉儲方法建構其資料庫架構，依據 ARC4.0 邏輯<lb/> 模式(ARC 4.0 Logical Model)資料顯示(ExLibris, 2015)，其事實資<lb/> 料表設計多半是以星狀綱要模式為主，少數雪花狀綱要模式；資料倉<lb/> 儲內之資料直接來自於 Aleph 自動化系統資料表，均未經過任何整合<lb/> 或前置處理，所提供之報表種類，對圖書館一般報表需求之支援有一<lb/> 定程度的助益。<lb/></p><p> 然而，在今日需求多變的環境，圖書館亦因環境管理需求、管理<lb/> 文化變異等問題，對有助於提升服務品質或是增進作業效益之資訊需<lb/> 求亦更迭不斷，以至於圖書館相關管理資訊報表之需求亦隨之增加。<lb/> 圖書館員之資訊素養於台灣這幾年圖書資訊教育下大有進步，圖書館<lb/> 員均具備一定程度之電腦操作能力，與新資訊技術知識學習的能力。<lb/> 因此，對於圖書館報表需求因已成館員作業需求之一，是否提供一可<lb/> 操作之作業流程或是環境架構，以供圖書館館員自我產出所需之報<lb/> 表？此為本研究之主要議題與目標！本研究藉由實際演練過之歷程說<lb/> 明，提出解決上述議題之參考模式及流程步驟，以及基本知能要求，<lb/> 供國內圖書館館員建構並產生自我所需之報表。<lb/></p><head> 參、研究方法<lb/></head><p> 一、個案研究<lb/> 本研究問題之起源，來自國內圖書館自動化系統廠商及大學圖書<lb/> 館對圖書館客製化報表之需求。依據該系統廠商過去維護與大學圖書<lb/> 館客製化報表需求彙整，共計有 93 種不同之報表類別，所涉及的相異<lb/> 資料欄位約有 50 項。針對此需求過去解決方式多數是由系統廠商技術<lb/> 支援產出，以維護費方式處理。但仍有以下幾個困難：<lb/></p><p> ( 一 ) 客製化報表需求會因不同圖書館各組之業務或是管理方式不同而<lb/> 有所差異，且有經常變動之問題；<lb/> ( 二 ) 系統廠商在成本壓力排擠下，客製化報表功能之完成時效性並不<lb/> 理想，經常性延遲交付；<lb/> ( 三 ) 客製化報表功能在圖書館自動化系統資料之快速成長下，執行效<lb/> 率漸趨惡化，必須耗費系統更多資源；<lb/> ( 四 ) 客製化報表功能執行期間與經常作業之系統功能間相互爭搶資<lb/> 源，致使圖書館自動化系統於上班時間難以正常運作(通常只能<lb/> 放棄即時報表產生)；<lb/> ( 五 ) 圖書館經費拮据，較難建置如 ARC 報表產生系統，供圖書館館<lb/> 員運用。<lb/></p><p> 另外，部分圖書館雖建置有類似於 ARC 之報表產生系統，但仍遇<lb/> 到以下的問題：<lb/> ( 一 ) 類似 ARC 報表產生系統，對圖書館員並不容易學習，尤其是不<lb/> 具資料庫經驗的館員，非短時間就能駕輕就熟地開發客製化報<lb/> 表；<lb/> ( 二 ) 此類報表系統多只適用於某廠系統預設報表產生，報表系統移植<lb/> 彈性差，投資成本效益不佳；<lb/> ( 三 ) 此類報表系統仍無法完全滿足客製化報表需求。<lb/></p><p> 藉由調查(以圖書資訊學研究所在職專班全體 25 位學生中，有<lb/> 21 位來自全國大專校院圖書館及公共圖書館館員，以作業方式調查各<lb/> 館之報表需求)、並蒐集國內圖書館自動化系統廠商累積十餘年來自<lb/> 其客戶之報表需求及所面臨的主要困境，本研究試圖提出解決上述諸<lb/> 多問題的可行方案，期望能提供國內圖書館對客製化圖書館自動化系<lb/> 統報表需求一有效且經濟的解決之道。本研究所提出之解決報表需求<lb/> 模式，為求其有效可行，透過館員及圖書資訊領域專家，針對所提解<lb/> 決方案模式進行實際演練，以驗證其效益。<lb/></p><p> 二、系統架構<lb/> 本研究所探討議題之資訊架構，在設計上是以低成本高效益以及<lb/> 可建構在各校圖書館內為前提，提出以下之系統架構如圖 6 所示：<lb/></p><p> 圖 6Ā 本研究系統架構(本研究整理)<lb/> 由以上系統架構圖可以看出，本研究環境以 SQL Server 及 EXCEL 為<lb/> 主，此兩軟體因微軟校園軟體方案故大多數圖書館並不需再額外花費成<lb/> 本建置。系統架構圖中，因資料倉儲是與圖書館自動化系統功能面切割，<lb/> 致使圖書館自動化系統未於圖中出現，僅以資料資源(data sources)呈現<lb/> 經由圖書館自動化系統所儲存之資料或是外部其他資料來源。<lb/></p><p> ( 一 ) 資料資源<lb/> 資料資源為資料倉儲(或超市)建構所需之資料來源，本研究中<lb/> 因只考量圖書館自動化系統之報表，故資料資源以圖書館自動化系統<lb/> 所儲存之資料為主。但因圖書館自動化系統資料繁雜，不易於館員理<lb/> 解，故建議應先以各作業單位所需之資料為目標，建構各組作業所需<lb/> 之資料超市。<lb/></p><p> ( 二 ) 事實資料表設計<lb/> 事實資料表設計為資料倉儲核心，本研究提出四步驟完成：(1)<lb/> 選定主題，簡單說，所謂的主題就是你想產生何種報表？如借閱報<lb/> 表、館藏報表等；(2)單位量，也就是計量的最小單位，若以讀者借<lb/> 閱為例，本研究所選定的最小單位為借出之一筆館藏；(3)選擇維<lb/> 度(Dimension)，這是件重要工作，所謂維度就是產生出來的報表資<lb/> 料以何種角度呈現，可以有多個，稱之為多維度，如讀者借閱報表，<lb/> 借閱館藏筆數呈現跟時間有關係，如日、週、月、季、學期、學年、<lb/> 日曆年等，此時就必須有一時間維度；(4)確認事實資料表(Fact<lb/> Table)，確定事實資料表中計算的量度(Measure)，在讀者借閱的例<lb/> 子中，本研究在第(2)步驟中已選定最小單位為借出之一筆館藏，所<lb/> 以此例子中的量度皆為 1。下圖 7 為一館藏借閱報表之事實資料表(用<lb/> 以建構一資料超市)：<lb/></p><p> 圖 7Ā 借閱冊數事實資料表設計<lb/> 此事實資料表之設計，可以產出以讀者、日期、館藏等不同角度<lb/> 借閱冊數之統計報表(其中借閱冊數為事實資料表之量度) ；如下圖 8：<lb/> 不同年不同館藏資料類型之借閱數量情形。<lb/></p><figure> 圖 8Ā 不同年不同館藏資料類型之借閱數量<lb/></figure><p> ( 三 ) 資料整合<lb/> 架構中之資料整合是目前 ARC 系統不足的地方，因為它會牽涉各<lb/> 館不同報表需求而不同，ARC 無法完全產生客製化報表。如上圖 7 事<lb/> 實資料表日期維度中之「學年度」或是「週」，圖書館自動化系統借<lb/> 閱資料並未有學年度或是週的欄位，只有借閱時間(於流通櫃台出納<lb/> 的時間)，因此無法產生各學年度或是各週借閱統計報表(當然，如<lb/> 果運用 SQL 查詢條件是可以解決此問題)。因此對於此需求，必須先<lb/> 將原有資料經過處理整合，以適合於從學年度或是週之維度呈現借閱<lb/> 資料。以「週」或是「學年度」之需求為例，可以透過建立時間概念<lb/> 階層(Concept Hierarchy)協助解決，時間概念階層即是時間階層化，<lb/> 如流通櫃台出納時間，可以記錄(彙整轉換)成：時間、日、週、月、<lb/> 季、年；亦或是：時間、日、月、學期、學年等時間階層；如此便可<lb/> 從不同學年度或是週檢視館藏借閱數量。<lb/></p><p> ( 四 ) 分析結果(EXCEL)<lb/> EXCEL 是一操作性極佳的線上分析處理(OLAP)工具，其樞紐<lb/> 分析功能與資料倉儲多維度概念一致，處理分層資料之解析彙整相當<lb/> 便利；同時，EXCEL 資料繪圖工具亦是簡單方便，對於統計報表資料<lb/> 視覺化之需求，足以勝任有餘。EXCEL 2013 以後之版本，其最大列數<lb/> (資料筆數)為 1,048,576 列，欄位最多為 16,384 欄，對多數圖書館<lb/> 以時間(月)為基準的報表需求，資料承載量應可以處理。因此在本<lb/> 研究中被視為資料倉儲結果輸出第一選擇之工具。<lb/></p><head> 肆、研究結果<lb/></head><p> 本研究在基於上述系統架構，首先提出一可行且成本效益考量之<lb/> 客製化圖書館報表作業之參考流程，並以實際個案說明；最後藉由圖<lb/> 書館員(專業館員及系統館員)及圖書資訊學研究生，針對圖書館<lb/> 實際需求，以本研究所提出之客製化報表模式實際建構完成所需之<lb/> EXCEL 報表，以分析驗證本研究之可行性與確實效益。<lb/></p><p> 一、圖書館自動化系統客製化報表建構模式<lb/> 以資料倉儲技術客製化圖書館報表，其基本仍是以資料倉儲為主<lb/> 體，故本研究所提出之參考流程部分參考現有資料探勘，並作必要調<lb/> 整以適用於圖書館運用，圖書館自動化系統客製化報表建構模式(資<lb/> 料倉儲應用模式)如下(圖 9)：<lb/></p><figure> 圖 9Ā 圖書館自動化系統製化報表建構模式(資料倉儲應用模式)<lb/></figure><p> 一 ) 確認主題目標<lb/> 整個作業流程第一件事情就是要確認主題目標，簡單的說就是要<lb/> 產生甚麼樣的報表。例如，典閱組需要流通統計資料(做甚麼用？要<lb/> 想清楚)，目的是「為了進一步分析學校各單位不同身分借閱圖書大<lb/> 很明確，圖書館員對此問題陳述要能夠越精準越有利於後續設計。<lb/></p><p> ( 二 ) 設計事實資料表<lb/> 事實資料表之設計主要是依據前述之目的，首先確定計量為何？<lb/> 再者確定檢視的維度；爾後依照事實資料表之設計，由作業階層資料<lb/> 庫擷取所需之與計量相關之維度資料，以建構特定目的之資料超市。<lb/> 延續以上流通統計資料案例，計量為借閱筆數；而維度包括學期時間、<lb/> 圖書館藏(大類)、讀者身分(教職員工，研究生或是大學部等)等，<lb/> 共有三個維度。其中系所單位可以進一步探討，以教學單位為例，其<lb/> 所屬學院。計量事實資料表及其維度資料表關聯構成如下圖 10 之雪花<lb/> 狀綱要模式。<lb/></p><figure> 圖 10Ā 流通統計事實資料表雪花狀綱要模式<lb/></figure><p> 三 ) 資料整合與轉換<lb/> ARC 類之報表系統較難支援者。其中概念階層(concept hierarchy)之<lb/> 建立為資料整合之關鍵知識。如上圖 10<lb/> 並非以學年、學期、季等值記錄，同時出納時間在應用上亦須經過處<lb/> 理才能分出年、月、週(日曆週)、天、上午、下午、晚上等值。若<lb/> 時間維度有此檢視資料之需求，就必須在資料庫資料擷取之前先建構<lb/> 時間概念階層：時段(上午、下午、晚上)、天、星期、日曆週或月、<lb/> 季、年；或是時段(上午、下午、晚上)、天、星期、日曆週、學期、<lb/> 學年等，端視檢視資料之需求設計。因各館各校學期或是每年之日曆<lb/> 週定義不同，故於資料庫轉出處理上就較為繁瑣複雜，這也是必須客<lb/> 製化的原因之一。上述流通統計學期維度檢視資料以學年及學期為主，<lb/> 故在資料庫轉出時必須將櫃台出納時間依據學校學年學期時間，另外<lb/> 改以新增學年、學期欄位登錄資料，如此才能以不同學年學期彙整分<lb/> 析流通借閱資料。<lb/></p><p> 依前所完成之事實資料表、維度資料表、整合轉換新增資料欄位<lb/> 等建立所對應之資料表；然後以資料擷取轉換載入工具(Extraction,<lb/> transformation and loading, ETL tools)(Kimball &amp; Ross, 2013)由作業層<lb/> 資料庫將所需之資料截取轉換載入至所建構之相對應資料表；抑或是<lb/> SQL 結構化查詢語言處理資料載入相關工作。此步驟為未具資<lb/> 料庫知能之圖書館員較多障礙之步驟，初期建議可由圖書館系統館員<lb/> 協助，館員可於初期過程學習資料庫觀念與 語法，以為後續自我<lb/> 半只能針對所指定之資料庫管理系統，因此建議以 SQL 語言是最直接<lb/> 經濟有效的方法。<lb/></p><p> ( 四 ) 資料立方體建構<lb/> Server)提供之工具(Microsoft<lb/> Visual Studio)或是支援資料倉儲(資料探勘)建構工具，根據所設計<lb/> 之上述資料表(事實資料表與維度資料表)間之關聯關係，宣告建構<lb/> 資料立方體，也就是所謂之資料倉儲。<lb/></p><p> ( 五 ) 線上分析處理(online analytical processing, OLAP)<lb/> 線上分析處理即為主要之使用者介面工具，能夠支援多維度檢<lb/> 視、分析、彙整目的資料，然其與 ETL 有類似之上述問題，因此在<lb/> 考量不增加成本前提下，本研究以 EXCEL 為推薦之 OLAP 工具，其<lb/> 樞紐分析(pivot)功能正與多維度資料檢視分析概念契合且操作容<lb/> OLAP 之使用者介面工具。當館員或是管理<lb/> 者於線上分析處理過程中，若發現結果並不符合需求，須修正原有設<lb/> 計，則回至(二)進行新增、修改或刪除原事實資料表設計內容後重<lb/> 新執行。<lb/></p><p> 二、客製化報表模式可行性及效益驗證實驗<lb/> 以下本研究即以實際案例之操作演練實驗，作為驗證上述所提步<lb/> 驟於圖書館應用之可行性及效益之驗證。實驗之進行包括圖書館典閱<lb/> 中系統館員具資料庫概念、SQL 語言撰寫能力(曾修習過資料庫相關<lb/> 課程)以及 SQL Server 實務操作能力；而圖書資訊學研究生為提供技<lb/> 術諮詢，除修習過資料庫與 SQL 語言課程外，亦曾選修實作資料倉儲<lb/></p><p> ( 一 ) 確認主題目標<lb/> 典閱組組長為充分了解讀者借閱相關訊息，期望能依據需求客製<lb/> 化借閱資料報表，以訪談引導方式瞭解需求：<lb/> 1. 主要產生何種資訊報表？統計人次或館藏量？(主題為何)<lb/> 2. 以何種角度檢視報表資訊？有何？(維度分析)<lb/> a. 以讀者角度檢視報表資訊，讀者需要分類？有何？(維度屬<lb/> b. 以時間角度檢視報表資訊，有哪些不同時間？(維度屬性)<lb/> c. 以館藏角度檢視報表資訊，有哪些館藏相關因素？(維度屬<lb/></p><p> 紀錄訪談結果整理後，再與系統館員與圖資所研究生討論確認主<lb/> 題，列出如下所述維度需求：(約經 65 分鐘討論)<lb/> 1. 依讀者之性別、系所、身份分析借閱資料；<lb/> 2. 依據館藏類號、館藏地、館藏類型分析借閱資料；<lb/> 3. 依據學年度、月、季、年分析借閱資料；<lb/></p><p> ( 二 ) 設計事實資料表<lb/> 表與維度資料表如下圖 11 之左所示；再與典閱組組長討論其需求並確<lb/> 定設計是否符合。討論過程中，對於以館藏館藏地分析資料之需求有<lb/> 所質疑，館藏地因該館可以跨館借閱且跨館館藏，館藏地為一變動項<lb/> 目且並非分析館藏借閱之重點；反倒是分析了解讀者之借閱於何處借<lb/> 閱的較為重要，因此修改原設計事實資料表，新增流通地維度以解決<lb/> 此需求之改變，結果如圖 11 之右所示。(約討論 75 分鐘後確定)<lb/></p><figure> 圖 11Ā 案例事實資料表設計<lb/></figure><p> 三 ) 資料整合與轉換<lb/> 對於借閱資料期望以時間軸檢視分析資料，可以學期或月或季等<lb/> 當的時間軸單位，自系統開始運作時間至蒐集資料之最後時間；為求<lb/> 資料處理之效益，由典閱組組長依其對時間軸單位需求，以 建<lb/> 立每年每日對應之，如下 EXCEL 所示：<lb/></p><p> 圖 12ĀEXCEL 處理日期時間單位<lb/> 以 EXCEL 產生對應之時間軸單位後，再轉入隨後於 SQL Server 所<lb/> 建立之時間維度資料表中。接著由系統館員(或圖資所研究生)依據<lb/> 上述確定之事實資料表與維度資料表，於 SQL 建置相對應之事<lb/> 實資料表與維度資料表(新增一資料庫後)，及資料表間之關聯。然<lb/> 後利用 SQL 語言將自動化系統中相關欄位資料匯入各資料表中；此步<lb/> 驟除須具備資料庫技術能力外，另一重要關鍵在於資料正確性之確定，<lb/> 即匯入所建構資料表之資料必須謹慎確定為正確所需之資料，此項工<lb/> 作必須由系統館員與自動化廠商系統工程師共同確認無誤。<lb/></p><p> ( 四 ) 資料立方體(資料倉儲)建構<lb/> Microsoft Visual Studio 2013 所建構，在<lb/> 新增一 Analysis Service 多維度和資料採礦專案之後，與 SQL Server 資料<lb/> 庫連線，並選擇先前所建立的資料庫做為資料來源 (如下圖 13 所示) ：<lb/> 圖右方的「方案總管」區塊，可設定資料來源與欲分析的資料庫與資<lb/> 料表連線，並新增 與其維度，設定的內容會顯示在圖中間和左方<lb/> 的區塊中。<lb/></p><figure> 圖 13Ā 資料立方體(資料倉儲)建構<lb/></figure><p> 接著新增建立一資料立方體(Cube)並依序設定相關之各維度與<lb/> 其屬性，結果如下圖 14 所示。最後執行部署即完成資料立方體(資料<lb/> 倉儲)之建構：圖 14 為 Cube 維度的設定與檢視，圖右方「資料來源<lb/> 檢視」的區塊中，為原始 SQL Server 資料庫中資料表的欄位，圖左方<lb/> 的「屬性」區塊為已設定加入 Cube 的欄位，若要新增 Cube 的欄位，<lb/> 將欲分析的欄位拖曳至左方屬性的區塊中即可。<lb/></p><figure> 圖 14Ā 案例部屬完成<lb/></figure><p> ( 五 ) 線上分析處理<lb/> 資料線上分析處理以 由圖書館館員操作，開啟已部署好之<lb/> Cube 的瀏覽器功能，匯出成 EXCEL 檔，要以樞紐分析表呈現，則將<lb/> 欲分析之資料欄位拖曳至檢視位置，得到 EXCEL 樞紐分析結果，如下<lb/> 圖 15 所示是以各學年度檢視不同類型館藏之借閱數量：圖右方可選擇<lb/> 欲分析或產生報表的欄位值，拖曳至右下方的「欄」或「列」區塊中，<lb/> 並將欲分析的數值欄位拖曳至「值」的區塊中，將欄位拖曳至「篩選」<lb/> 區塊，可限縮資料的範圍，結果呈現於圖左方 EXCEL 樞紐分析中。<lb/></p><figure> 圖 15ĀEXCEL 樞紐分析(線上分析處理)<lb/></figure><p> EXCEL 檔<lb/> 案，輸出統計分析數字或是繪製圖表等圖書館作業管理客製化報表。<lb/></p><p> 三、模式驗證實驗討論<lb/></p><p> 以資料倉儲技術實踐圖書館彈性客製化報表產生是本研究主要目<lb/> 的，在考量目前圖書館人力資源侷限及經費捉襟見肘的困境下，提出<lb/> 此客製化報表模式。本研究於其可行性及效益驗證實驗，以一 3 人參<lb/> 與之圖書館案例說明，亦是在此考量下進行，以最少人力評估其可行<lb/> 性。<lb/></p><p> 資料倉儲之應用，向來不是資訊技術問題，因其主題導向特性，<lb/> 向來是專業領域需求問題。以同樣之模式，亦進行其他 2 類需求報表<lb/> 之開發，如下表 1 之資料整理。其中訪談引導對象除本文所列之典閱<lb/> 組組長外，另有圖書館系統館員及系統公司 PM(專案經理)，可發現<lb/> 系統公司專案經理在專業領域(圖書館、自動化系統、資料庫)之知<lb/> 能較優於圖書館員，故其訪談引導事實資料表需求時間較短；然所列<lb/> 三個案例之報表開發時間，以同一組系統館員及圖書資訊學研究所研<lb/> 究生進行，報表開發時間均優於過往圖書館尋求自動化系統廠商開發<lb/> 所耗費之時間。<lb/></p><figure type="table"> 表 1<lb/> 需求報表開發比較<lb/> 訪談引導<lb/> 對象<lb/> 圖書館<lb/> 知能<lb/> 知能<lb/> 訪談引導<lb/> ( 分鐘 )<lb/> 維度資料表<lb/> 建構 ( 分鐘 )<lb/> 事實資料<lb/> 表建構<lb/> ( 分鐘 )<lb/> 資料倉<lb/> 儲建構<lb/> ( 分鐘 )<lb/> 讀者借閱<lb/> 圖書<lb/> 典閱組<lb/> 組長<lb/> 圖書資訊<lb/> 碩士<lb/> 無<lb/> 65<lb/> 300+480+360+<lb/> 60=1200<lb/> 90<lb/> 讀者預約<lb/> 圖書<lb/> 圖書館系<lb/> 統館員<lb/> 資訊工程<lb/> 碩士<lb/> 資料庫設<lb/> 計經驗<lb/> 67<lb/> 維度同上無<lb/> 需再建構<lb/> 60<lb/> 30<lb/> 讀者續借<lb/> 圖書<lb/> 系統公司<lb/> PM<lb/> 圖書資訊<lb/> 碩士<lb/> 資料庫設<lb/> 計經驗<lb/> 50<lb/> 維度同上無<lb/> 需再建構<lb/> 60<lb/> 30<lb/></figure><p> 開發需求報表花費時間最多的是在於維度資料表的建構，此個案<lb/> 是以國內自動化系統廠商所提供之某大專校院圖書館 1998 年至 2014<lb/> 年之資料為主，共計 252200 筆借閱資料，館藏資料 178605 筆，讀者<lb/> 資料 21923 人，在 CPU 為 i5，記憶體 8G 的個人電腦下，花費約 20<lb/> 小時(1200 分鐘)完成所需之維度資料表建構(共有四個維度資料表，<lb/> 表格中之數字 300、480、360、60 為其各別建構所需之時間)。各資<lb/> 料表建構所需之時間，與所涉及之資料量有絕對關係，而開發之電腦<lb/> 系統環境效能的影響亦不可忽略。<lb/></p><p> 圖書館員對資料倉儲或是資料探勘技術之應用，經常擔心其高門<lb/> 檻之技術問題，然事實並非如此，本研究所提出之模式即是要破除此<lb/> 迷思。圖書館館員只要專注於需求報表的正確完整陳述(此項工作並<lb/> 不容易，亦為資料倉儲應用於圖書館困難之所在)，且所必要之資料<lb/> 確實存在自動化系統資料庫中，後續相關資料庫、資料倉儲建構等，<lb/> 均可委由具資料庫開發、資料倉儲建構、SQL Server 應用經驗之系統<lb/> 館員接手處理。<lb/></p><head> 伍、結論與建議<lb/></head><p> 圖書館客製化報表需求一直以來是圖書館亟欲解決的問題，縱然<lb/> 今日有如 ARC 報表系統可供圖書館運用，但因其專屬性為特定圖書館<lb/> 系統獨用、利用資料倉儲技術建構預設可能報表缺乏彈性、館員學習<lb/> 不易且若無資料庫知能實作開發仍需系統館員協助、圖書館需額外付<lb/> 費此系統功能其成本效益不彰等因素，圖書館客製化報表需求仍舊為<lb/> 今日圖書館至為棘手之困境。本研究以國內圖書館自動化系統廠商累<lb/> 積多年來自用戶之報表需求為基礎，提出以 SQL Server 與 EXCEL 為環<lb/> 境之具成本效益解決模式，藉由資料倉儲技術協助圖書館員客製化需<lb/> 求報表之發展；並以實際圖書館案例實證其可行性。<lb/></p><p> 於圖書館客製化報表案例實證過程發現，對於參與實驗之圖書館<lb/> 等仍嫌不足，<lb/> 尚需圖書館系統館員多所指導協助，此為圖書館爾後可以加強館員訓<lb/> 練與強化之內容。同時，因本研究所提出之建構模式，除資料擷取轉<lb/> 換需有程度以上之 SQL 查詢語言能力外，其餘皆為例行性操作動作且<lb/> 差異不大(僅資料欄位名稱或是資料表名稱不同)，故圖書館自動化<lb/> 系統管理者，可以考慮此模式建立一標準作業流程規範及模板或模組，<lb/> 供圖書館專業館員更有效率之運用，以發展個別客製化需求之資料超<lb/> 市或報表。<lb/></p><p> 圖書館客製化報表需求可以資料超市建構模式解決圖書館館內各<lb/> 組需求，若進一步整合全館各組所建構之資料超市，逐步形塑圖書館<lb/> 整體客製化需求報表之資料倉儲；後續可以進一步考量以此資料倉儲<lb/> 為基礎，發展建構圖書館之管理資訊系統(Management Information<lb/> System, MIS) 或 高 階 主 管 資 訊 系 統(Executive Information System,</p></text></tei>